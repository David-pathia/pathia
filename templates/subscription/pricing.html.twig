{# templates/subscription/pricing.html.twig #}
{% extends 'base.html.twig' %}

{% block body %}
        <div class="pricing-container">
            <div class="text-center py-5">
                <img src="{{ asset('images/logo_pathIA.jpg') }}" width="220" class="stark-logo">
                <h1 class="mt-4" style="color: var(--stark-gold); font-weight: 800; letter-spacing: 2px;">
                    PROTOCOLES D'ACCÈS
                </h1>
            </div>

            {# Grille d'abonnements aérée #}
            <div class="pricing-grid">
                {# templates/subscription/pricing.html.twig #}

                {% for plan in plans %}
                    <div class="card-stark">
                        {# ... (nom et prix du plan) ... #}

                        <ul class="feature-list">
                            {% for feature in plan.features %}
                                <li class="{% if is_granted('ACCESS_FEATURE', feature.name) %}text-success fw-bold{% endif %}">
                                    {{ feature.name }}
                                    {% if is_granted('ACCESS_FEATURE', feature.name) %}
                                        <i class="bi bi-check-circle-fill ms-2"></i> {# Icône "Débloqué" #}
                                    {% endif %}
                                </li>
                            {% endfor %}
                        </ul>

                        <div class="mt-auto">
                            {# Logique du bouton d'action #}
                            {% set has_all_features = true %}
                            {% for feature in plan.features %}
                                {% if not is_granted('ACCESS_FEATURE', feature.name) %}
                                    {% set has_all_features = false %}
                                {% endif %}
                            {% endfor %}

                            {% if has_all_features %}
                                <button class="btn btn-secondary w-100 mt-auto" disabled>
                                    PROTOCOLE ACTIF
                                </button>
                            {% else %}
                                <a href="{{ path('app_subscribe_process', {'id': plan.id}) }}" class="btn-protocol w-100">
                                    ACTIVER LE PLAN
                                </a>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
{% endblock %}
